{
  "hash": "8398a70f69e5eab41eb7ffda94574063",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ARIMA modeling using bonds and petrol prices data\"\nauthor: \"Zahid Asghar\"\ndate: today\nfooter: \"[Forecasting](zahidasghar.com/courses)\"\nformat:\n  typst:\n    theme: [default, custom.css,styles.scss]\n    \nexecute: \n  warning: false\n  echo: false\n---\n\n\n\n\n\n## Load data and relevant libraries\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 960 × 4\n   caldt          b1ret   t30ret  cpiret\n   <chr>          <dbl>    <dbl>   <dbl>\n 1 31/01/1942  0.00266  0.000178 0.0129 \n 2 28/02/1942  0.000887 0.000111 0.00637\n 3 31/03/1942 -0.000143 0.000108 0.0127 \n 4 30/04/1942 -0.000481 0.000068 0.00625\n 5 29/05/1942  0.000433 0.000161 0.0124 \n 6 30/06/1942  0.00065  0.000249 0      \n 7 31/07/1942 -0.000304 0.000252 0.00614\n 8 31/08/1942  0.000629 0.000307 0.00610\n 9 30/09/1942  0.000481 0.000281 0      \n10 31/10/1942  0.00109  0.000343 0.0121 \n# ℹ 950 more rows\n```\n\n\n:::\n:::\n\n\n## Inspect data\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 960\nColumns: 4\n$ b1ret  <dbl> 0.002663, 0.000887, -0.000143, -0.000481, 0.000433, 0.000650, -…\n$ t30ret <dbl> 0.000178, 0.000111, 0.000108, 0.000068, 0.000161, 0.000249, 0.0…\n$ cpiret <dbl> 0.012903, 0.006369, 0.012658, 0.006250, 0.012422, 0.000000, 0.0…\n$ date   <date> 1942-01-31, 1942-02-28, 1942-03-31, 1942-04-30, 1942-05-29, 19…\n```\n\n\n:::\n:::\n\n\n\nOnce we have data in required format, we can proceed to handle the questions asked about it.\n\n\n## Description of the problem on bonds data\nIn all the following questions above mentiond data frame is used.\n In this problem, we are interested in the time series properties of bond returns. We collect monthly data from 1942M01 to 2021M12 for the following variables:\n\n-   `b1ret` denotes the 1-year bond return,\n\n-   `t30ret` denotes the 30-day return on treasury bill,\n\n-   `cpiret` denotes the inflation rate.\n\nWe will be focusing on the bond return variable b1ret throughout this analysis. Create a second variable b1ret1 from the original variable, where `b1ret1` has observations from 1942M01 to 2020M12. We will be using `b1ret1` for estimation, and forecast the months of 2021 at the end.\n\n### a) Plot the TS variable and comment on its features.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ARIMA_files/figure-typst/fig-plot-1.svg){#fig-plot}\n:::\n:::\n\n\n\nThis @fig-plot indicates that around 1980s, these bond returns were highly volatile and from 1970-1990s period is also of high return period. In mid 2010, these returns show very promising growth but then after 2008 crisis bonds return have least volatility closely mirroring 1940s.\n\n### b) Estimate a quadratic trend for this TS variable. Write down the equation and test the regression residuals \"Res1\" for stationary and autocorrelation.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic   p.value\n  <chr>           <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)  5.54e- 3  1.94e- 4      28.6 1.17e-130\n2 Date         3.26e- 7  2.53e- 8      12.9 5.55e- 35\n3 I(Date^2)   -3.62e-11  2.19e-12     -16.6 2.34e- 54\n```\n\n\n:::\n:::\n\n\n\n### c) Using the ACF and PACF for the stationary version of Res1 to propose an initial ARIMA model for Res1.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![ACF plots of the residuals of the quadratic trend model](ARIMA_files/figure-typst/fig-plot1-1.svg){#fig-plot1}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![PACF plots of the residuals of the quadratic trend model](ARIMA_files/figure-typst/fig-plot2-1.svg){#fig-plot2}\n:::\n:::\n\n\n\n\n@fig-plot1 and @fig-plot2 indicates that residuals are not stationary and have significant autocorrelation at lag 1. So we may need to further investigate the model.\n\n\n\n\n\n### d) Provide several ARIMA models and discuss which ARIMA model you would pick as the final model. Explain your reasoning.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n          Order       AIC\n1  ARIMA(0,0,0) -7489.192\n2  ARIMA(0,0,1) -7649.737\n3  ARIMA(0,0,2) -7669.217\n4  ARIMA(0,1,0) -7378.844\n5  ARIMA(0,1,1) -7795.822\n6  ARIMA(0,1,2) -7826.394\n7  ARIMA(1,0,0) -7696.349\n8  ARIMA(1,0,1) -7804.604\n9  ARIMA(1,0,2) -7833.807\n10 ARIMA(1,1,0) -7516.357\n11 ARIMA(1,1,1) -7822.932\n12 ARIMA(1,1,2) -7829.002\n13 ARIMA(2,0,0) -7709.165\n14 ARIMA(2,0,1) -7830.262\n15 ARIMA(2,0,2) -7836.822\n16 ARIMA(2,1,0) -7613.721\n17 ARIMA(2,1,1) -7825.043\n18 ARIMA(2,1,2) -7828.701\n```\n\n\n:::\n:::\n\n\n\n\nAs per @fig-plot we have observed in the plot that the bond returns are not stationary and have significant autocorrelation at lag 1. So we may need to further investigate the model. We have estimated a quadratic trend model and residuals are not stationary. We have calculated ACF and PACF of residuals and found that residuals are not stationary and have significant autocorrelation at lag 1. We have estimated several ARIMA models and the\n\nBest model comes out to be ARIMA(1,0,1). So we are estimating model as follows:\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  term      estimate std.error\n  <chr>        <dbl>     <dbl>\n1 ar1        0.991     0.00545\n2 ma1       -0.904     0.0194 \n3 intercept  0.00322   0.00128\n```\n\n\n:::\n:::\n\n\n\n### e) Forecast using both trend and ARIMA(1,0,1) models\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nTime Series:\nStart = 961 \nEnd = 970 \nFrequency = 1 \n [1] 0.0005113466 0.0005364218 0.0005612652 0.0005858789 0.0006102650\n [6] 0.0006344256 0.0006583628 0.0006820787 0.0007055753 0.0007288547\n```\n\n\n:::\n:::\n\n\n\n### Forecast from quadratic trend model\n\n$$y_t = \\beta_0 + \\beta_1 t + \\beta_2 t^2 + \\epsilon_t$$ {#eq-qt}\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\nAs @eq-qt suggests, we can use the quadratic trend model to forecast the bond returns.\n\n### 2. \n\nIn this problem, we are interested in examining the factors affecting the petrol prices. Petrol prices in New Zealand is split into three components: importer cost, importer's margin, and the taxes. We collect the weekly data on the following variables from 2004W16 (week 16) to 2020W23 (week 23):\n\n-   Dubai denotes the Dubai crude oil prices,\n\n-   Price denotes the discounted retail petrol price,\n\n-   Margin denotes the importer's margin,\n\n-   Cost denotes the importer's cost.\n\nWe will be focusing on the variable Margin and Cost throughout this analysis. We will also restrict our attention to the period from 2004W16 to 2019W52 for estimation. We will be forecasting the first 23 weeks of 2020 at the end. You can find the dataset titled \"PetrolPrices.csv\", use the 5% significance level. Please follow the procedure below for the analysis:\n\n## Load and Inspect data\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 840\nColumns: 5\n$ Week_ending_Friday <chr> \"4/23/2004\", \"4/30/2004\", \"5/7/2004\", \"5/14/2004\", …\n$ Dubai              <dbl> 50.74, 52.16, 52.94, 56.55, 59.40, 56.68, 56.13, 53…\n$ Cost               <dbl> 48.6, 52.2, 53.3, 56.4, 54.3, 53.7, 49.4, 48.2, 47.…\n$ Price              <dbl> 114.5, 113.0, 117.3, 121.9, 121.3, 123.9, 123.6, 12…\n$ Margin             <dbl> 13.9, 11.8, 13.8, 14.2, 12.6, 11.8, 13.6, 11.5, 14.…\n```\n\n\n:::\n:::\n\n\nSo first there is need to convert Week_ending_Friday as `date` variable.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 840\nColumns: 6\n$ Week_ending_Friday <chr> \"4/23/2004\", \"4/30/2004\", \"5/7/2004\", \"5/14/2004\", …\n$ Dubai              <dbl> 50.74, 52.16, 52.94, 56.55, 59.40, 56.68, 56.13, 53…\n$ Cost               <dbl> 48.6, 52.2, 53.3, 56.4, 54.3, 53.7, 49.4, 48.2, 47.…\n$ Price              <dbl> 114.5, 113.0, 117.3, 121.9, 121.3, 123.9, 123.6, 12…\n$ Margin             <dbl> 13.9, 11.8, 13.8, 14.2, 12.6, 11.8, 13.6, 11.5, 14.…\n$ date               <date> 2004-04-23, 2004-04-30, 2004-05-07, 2004-05-14, 20…\n```\n\n\n:::\n:::\n\n\nPerfect. Now we have date variable and 4 other variables measured as `dbl` means continuous.\n\n(a) Plot the margin and cost variables and comment on their features. De termine the order of integration for the two variables. Define the hypotheses and report the relevant test statistic and P-value. Interpret your findings.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ARIMA_files/figure-typst/unnamed-chunk-13-1.svg)\n:::\n:::\n\n\n\n\n\n\n(b)  Estimate the model where Margin is regressed on a linear trend and Cost. Write down the equation and comment on the coefficient of Cost. Test the regression residuals \"Res2\" for stationarity, autocorrelation, and heteroskedasticity.\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic   p.value\n  <chr>           <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept) -33.9     1.20          -28.2 3.30e-123\n2 date          0.00393 0.0000693      56.8 2.42e-289\n3 Cost         -0.0819  0.00660       -12.4 1.37e- 32\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ARIMA_files/figure-typst/unnamed-chunk-14-1.svg)\n:::\n\n::: {.cell-output-display}\n![](ARIMA_files/figure-typst/unnamed-chunk-14-2.svg)\n:::\n:::\n\n\n\n\n(c) Analyse the variable Res2 and propose a final ARIMA model for this variable.\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Res2 \nARIMA(1,0,0) with zero mean \n\nCoefficients:\n         ar1\n      0.8199\ns.e.  0.0197\n\nsigma^2 = 3.807:  log likelihood = -1753.46\nAIC=3510.91   AICc=3510.93   BIC=3520.38\n```\n\n\n:::\n:::\n",
    "supporting": [
      "ARIMA_files\\figure-typst"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}