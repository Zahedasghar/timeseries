{
  "hash": "27ea0ec6a8a769c247bcdf1f29ba65ac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Panel Data Modeling in R\"\nauthor: \"Zahid Asghar\"\nformat:\n  html: \n    highlight: tango\n    number_sections: yes\n    theme: united\n    toc: true\n    toc_float: true\n    toc_collapsed: true\n    toc_depth: 2\nexecute:\n  freeze: auto\n---\n\n\n\n# Introduction\n\nThis presentation demonstrates panel data modeling using the `plm` package in R. We will use the `Produc` dataset, which contains data on gross state product in the United States.\n\n# Load Libraries and Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plm)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::between() masks plm::between()\n✖ dplyr::filter()  masks stats::filter()\n✖ dplyr::lag()     masks plm::lag(), stats::lag()\n✖ dplyr::lead()    masks plm::lead()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tseries)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: zoo\n\nAttaching package: 'zoo'\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(sandwich)\n\n# Load the data\ndata(\"Produc\", package = \"plm\")\nhead(Produc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    state year region     pcap     hwy   water    util       pc   gsp    emp\n1 ALABAMA 1970      6 15032.67 7325.80 1655.68 6051.20 35793.80 28418 1010.5\n2 ALABAMA 1971      6 15501.94 7525.94 1721.02 6254.98 37299.91 29375 1021.9\n3 ALABAMA 1972      6 15972.41 7765.42 1764.75 6442.23 38670.30 31303 1072.3\n4 ALABAMA 1973      6 16406.26 7907.66 1742.41 6756.19 40084.01 33430 1135.5\n5 ALABAMA 1974      6 16762.67 8025.52 1734.85 7002.29 42057.31 33749 1169.8\n6 ALABAMA 1975      6 17316.26 8158.23 1752.27 7405.76 43971.71 33604 1155.4\n  unemp\n1   4.7\n2   5.2\n3   4.7\n4   3.9\n5   5.5\n6   7.7\n```\n\n\n:::\n:::\n\n\n\n# Data Description\n\nThe `Produc` dataset contains the following variables: \n\n- `state`: State name\n- `year`: Year\n- `region`: Region\n- `pcap`: Real per capita personal consumption expenditures\n- `hwy`: Real per capita \"highway\" expenditure\n- `water`: Real per capita \"water\" expenditure\n- `util`: Real per capita \"utility\" expenditure\n- `pc`: Real per capita net income\n- `gsp`: Real gross state product\n- `emp`: Employment\n- `unemp`: Unemployment rate\n\n## Ploting GSP over Time\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Produc, aes(x = year, y = gsp, color = state)) +\n  geom_line() +\n  theme_minimal() +\n  labs(title = \"Gross State Product over Time\",\n       x = \"Year\",\n       y = \"Gross State Product (GSP)\")\n```\n\n::: {.cell-output-display}\n![](panel_data_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## Correlation plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrelation_matrix <- Produc %>% select_if(is.numeric) %>% cor()\ncorrplot::corrplot(correlation_matrix, method = \"color\", type = \"upper\", tl.cex = 0.7)\n```\n\n::: {.cell-output-display}\n![](panel_data_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Boxplot of GSP by Region\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Produc, aes(x = region, y = gsp, fill = region)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(title = \"Gross State Product by Region\",\n       x = \"Region\",\n       y = \"Gross State Product (GSP)\")\n```\n\n::: {.cell-output-display}\n![](panel_data_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Boxplot of Employment by Region\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Produc, aes(x = region, y = emp, fill = region)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(title = \"Employment by Region\",\n       x = \"Region\",\n       y = \"Employment\")\n```\n\n::: {.cell-output-display}\n![](panel_data_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Scatterplot of GSP vs. Employment by State\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Produc, aes(x = emp, y = gsp, color = state)) +\n  geom_point() +\n  theme_minimal() +\n  labs(title = \"Gross State Product vs. Employment by State\",\n       x = \"Employment\",\n       y = \"Gross State Product (GSP)\")\n```\n\n::: {.cell-output-display}\n![](panel_data_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Unit Root Tests\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selecting only numeric columns for the ADF test\nnumeric_cols <- Produc %>% select_if(is.numeric) |> select( -year)\n\n# Applying unit root test for panel data\nadf_test <- sapply(numeric_cols, function(x) adf.test(x)$p.value)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n\nWarning in adf.test(x): p-value smaller than printed p-value\n```\n\n\n:::\n\n```{.r .cell-code}\nadf_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n pcap   hwy water  util    pc   gsp   emp unemp \n 0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 \n```\n\n\n:::\n:::\n\n\n\n## Fit Pooled OLS Model\n\n## Pooled OLS model \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npooled_ols <- plm(gsp ~ emp + unemp + pc, data = Produc, model = \"pooling\")\nsummary(pooled_ols) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPooling Model\n\nCall:\nplm(formula = gsp ~ emp + unemp + pc, data = Produc, model = \"pooling\")\n\nBalanced Panel: n = 48, T = 17, N = 816\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-26661.5  -4068.9   1503.0   3784.0  40850.0 \n\nCoefficients:\n               Estimate  Std. Error t-value  Pr(>|t|)    \n(Intercept) -3.8305e+03  8.0097e+02 -4.7824 2.057e-06 ***\nemp          3.0144e+01  3.2554e-01 92.5964 < 2.2e-16 ***\nunemp       -3.4768e+02  1.1538e+02 -3.0133  0.002665 ** \npc           2.4878e-01  1.0142e-02 24.5292 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    3.9905e+12\nResidual Sum of Squares: 4.2567e+10\nR-Squared:      0.98933\nAdj. R-Squared: 0.98929\nF-statistic: 25103.7 on 3 and 812 DF, p-value: < 2.22e-16\n```\n\n\n:::\n:::\n\n\n\n## Fixed Effects Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfixed_effects <- plm(gsp ~ emp + unemp + pc, data = Produc, model = \"within\")\nsummary(fixed_effects) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOneway (individual) effect Within Model\n\nCall:\nplm(formula = gsp ~ emp + unemp + pc, data = Produc, model = \"within\")\n\nBalanced Panel: n = 48, T = 17, N = 816\n\nResiduals:\n      Min.    1st Qu.     Median    3rd Qu.       Max. \n-12824.764   -912.582    -50.175    720.388  20701.742 \n\nCoefficients:\n         Estimate  Std. Error t-value  Pr(>|t|)    \nemp     34.611677    0.926593 37.3537 < 2.2e-16 ***\nunemp -289.266470   59.882397 -4.8306 1.645e-06 ***\npc       0.134576    0.021505  6.2579 6.495e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    1.3289e+11\nResidual Sum of Squares: 5628300000\nR-Squared:      0.95765\nAdj. R-Squared: 0.95488\nF-statistic: 5765.77 on 3 and 765 DF, p-value: < 2.22e-16\n```\n\n\n:::\n:::\n\n\n\n## Random Effects Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrandom_effects <- plm(gsp ~ emp + unemp + pc, data = Produc, model = \"random\")\nsummary(random_effects) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOneway (individual) effect Random Effect Model \n   (Swamy-Arora's transformation)\n\nCall:\nplm(formula = gsp ~ emp + unemp + pc, data = Produc, model = \"random\")\n\nBalanced Panel: n = 48, T = 17, N = 816\n\nEffects:\n                   var  std.dev share\nidiosyncratic  7357308     2712 0.132\nindividual    48523782     6966 0.868\ntheta: 0.906\n\nResiduals:\n     Min.   1st Qu.    Median   3rd Qu.      Max. \n-12211.93   -892.86    152.54    872.54  20739.86 \n\nCoefficients:\n               Estimate  Std. Error z-value  Pr(>|z|)    \n(Intercept) -4347.08517  1193.82256 -3.6413 0.0002712 ***\nemp            33.06917     0.73227 45.1600 < 2.2e-16 ***\nunemp        -331.96706    57.93287 -5.7302 1.003e-08 ***\npc              0.16804     0.01800  9.3353 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    1.6699e+11\nResidual Sum of Squares: 6012600000\nR-Squared:      0.96399\nAdj. R-Squared: 0.96386\nChisq: 21740.2 on 3 DF, p-value: < 2.22e-16\n```\n\n\n:::\n:::\n\n\n\n## Hausman Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhausman_test <- phtest(fixed_effects, random_effects)\nhausman_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman Test\n\ndata:  gsp ~ emp + unemp + pc\nchisq = 7.9388, df = 3, p-value = 0.04729\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n:::\n\n\n\n## Model comparison Breusch-Pagan test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_test <- plmtest(fixed_effects, effect = \"twoways\", type = \"bp\")\nbp_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tLagrange Multiplier Test - two-ways effects (Breusch-Pagan)\n\ndata:  gsp ~ emp + unemp + pc\nchisq = 4755.8, df = 2, p-value < 2.2e-16\nalternative hypothesis: significant effects\n```\n\n\n:::\n:::\n\n\n\n## Model comparison F-test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf_test <- pFtest(fixed_effects, random_effects)\nf_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test for individual effects\n\ndata:  gsp ~ emp + unemp + pc\nF = 1.1113, df1 = 47, df2 = 765, p-value = 0.2856\nalternative hypothesis: significant effects\n```\n\n\n:::\n:::\n\n\n\n## Robustness Check with Clustered Standard Errors \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclustered_se <- coeftest(fixed_effects, vcov = vcovHC(fixed_effects, type = \"HC1\"))\nclustered_se\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nt test of coefficients:\n\n         Estimate  Std. Error t value Pr(>|t|)    \nemp     34.611677    2.731771 12.6701  < 2e-16 ***\nunemp -289.266470  123.251462 -2.3470  0.01918 *  \npc       0.134576    0.069376  1.9398  0.05277 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Summary \n\nThis presentation demonstrated panel data modeling using the plm package in R. We covered data exploration, unit root testing, fitting pooled, fixed, and random effects models, and comparing these models using statistical tests.\n",
    "supporting": [
      "panel_data_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}